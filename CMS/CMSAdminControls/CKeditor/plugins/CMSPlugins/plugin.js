var CMSPlugin={window:this.window,requires:["iframedialog","fakeobjects"],currentEditor:null,lang:["en"],regNumber:/^\d+(?:\.\d+)?$/,regFlashFilename:/\.swf(?:$|\?)/i,selection:null,selectedElement:null,selectionBookmarks:null,cssifyLength:function cssifyLength(a){if(CMSPlugin.regNumber.test(a)){return a+"px"}return a},createFakeControl:function(c,f){if(c!==null){var d=null,h=c.attributes.type.toLowerCase(),a;switch(h){case"youtubevideo":d=f.createFakeParserElement(c,"cke_youtube","object",true);d.attributes.cms_youtube="true";d.attributes.cms_disable_media="true";break;case"flash":case"media":var j=this.getMediaType(c,f);if((j==="flash")||(h==="flash")){d=f.createFakeParserElement(c,"cke_flash","object",true);d.attributes.cms_media="true"}else{d=f.createFakeParserElement(c,"cke_media","object",true);d.attributes.cms_media="true"}break;case"mediafilecontrol":d=f.createFakeParserElement(c,"cke_old_media","object",true);d.attributes.cms_media="true";break;case"image":if(!(c.attributes.width&&(parseInt(c.attributes.width,10)>0)&&c.attributes.height&&(parseInt(c.attributes.height,10)>0))){a=this.getElementObject(c);
if(a){if((!c.attributes.width||(parseInt(c.attributes.width,10)<=0))&&(!c.attributes.height||(parseInt(c.attributes.height,10)<=0))){c.attributes.width=a.originalwidth;c.attributes.height=a.originalheight}else{if(!c.attributes.height||(parseInt(c.attributes.height,10)<=0)){c.attributes.height=Math.round(c.attributes.width/((parseFloat(a.originalwidth))/a.originalheight))}else{if(!c.attributes.width||(parseInt(c.attributes.width,10)<=0)){c.attributes.width=Math.round(c.attributes.height/((parseFloat(a.originalheight))/a.originalwidth))}}}}}d=f.createFakeParserElement(c,"cke_image","object",true);d.attributes.cms_media="true";var e=this.getImageUrl(c,f);if(e){d.attributes.src=e}break;case"widget":a=this.getElementObject(c);d=f.createFakeParserElement(c,"cke_widget","object",true);d.attributes.cms_disable_media="true";d.attributes.cke_widget="true";if(a.image_guid){g=d.attributes.style||"";d.attributes.style=g+"background-image:url("+f.config.ApplicationPath+"CMSPages/GetMetaFile.aspx?fileguid="+a.image_guid+"&maxsidesize=32);"
}if(a.widget_displayname){d.attributes.title=a.widget_displayname.replace(/\+/g," ")}break;default:d=f.createFakeParserElement(c,"cke_inlinecontrol","object",false);d.attributes.cms_disable_media="true";break}d.attributes.cms_inline="true";d.attributes.alt="";var g=d.attributes.style||"",b=c.attributes.width,i=c.attributes.height;if(h.toLowerCase()!="widget"){d.attributes.title="";if(typeof b!="undefined"){g=d.attributes.style=g+"width:"+this.cssifyLength(b)+";"}if(typeof i!="undefined"){g=d.attributes.style=g+"height:"+this.cssifyLength(i)+";"}}return d}else{return null}},getNodeList:function(a){return new CKEDITOR.dom.nodeList(a)},getElementObject:function(c){var e={},a,d;if(c){var b;if(c._){for(b=0;b<c.children.length;b++){a=c.children[b].attributes.name;d=c.children[b].attributes.value;e[a]=d}}else{for(b=0;b<c.children.length;b++){a=c.children[b].getAttribute("name");d=c.children[b].getAttribute("value");e[a]=d}}}return e},getCurrentEditor:function(){if(this.currentEditor!==null){return this.currentEditor}else{if(CKEDITOR.currentInstance!==null){return CKEDITOR.currentInstance
}}return null},getImageUrl:function(b,c){c=c||this.getCurrentEditor();var a=null,d=CMSPlugin.getElementObject(b);if(d.url){a=d.url;if(a.indexOf("~/")===0){a=a.replace("~/",c.config.ApplicationPath)}}return a},getMediaType:function(a){var b=this.getElementObject(a);if(b.cms_type){return b.cms_type.toLowerCase()}if(((b.ext)&&(b.ext.toLowerCase()===".swf"))||CMSPlugin.isFlashEmbed(a)){return"flash"}return"audiovideo"},isFlashEmbed:function(b){var a=b.attributes;return(a.type=="application/x-shockwave-flash"||a.type=="flash"||CMSPlugin.regFlashFilename.test(a.src||""))},initCss:function(a){var b="background-position: center center;"+"background-repeat: no-repeat;"+"border: 1px solid #CCC;"+"width: 80px;"+"height: 80px;";CKEDITOR.addCss("img.cke_inlinecontrol { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/CMSInline_bg.png")+");"+b+"}");CKEDITOR.addCss("img.cke_youtube { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertYouTube_bg.png")+");"+b+"}");CKEDITOR.addCss("img.cke_media { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImageOrMedia_bg.png")+");"+b+"}");
CKEDITOR.addCss("img.cke_flash { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertFlash_bg.png")+");"+b+"}");CKEDITOR.addCss("img.cke_widget { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertWidget_bg.png")+");"+b+"width: 32px;"+"height: 32px;"+"}");CKEDITOR.addCss("img.cke_old_media { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImageOrMediaOld_bg.png")+");"+b+"}")},openWidget:function(h,f,a,c,i){this.currentEditor=h;var b,g=h.getSelection().getSelectedElement();if(h.config.IsLiveSite){b=h.config.ApplicationPath+"CMSModules/Widgets/LiveDialogs/"+f}else{b=h.config.ApplicationPath+"CMSModules/Widgets/Dialogs/"+f}if((g)&&g.hasAttribute("cms_inline")){var d=h.restoreRealElement(g),e=this.getInline(d.$);if((e.cms_type==="widget")&&((a===null)||(a===e.name))){if(h.config.IsLiveSite){b=h.config.ApplicationPath+"CMSModules/Widgets/LiveDialogs/WidgetProperties.aspx?inline=true"}else{b=h.config.ApplicationPath+"CMSModules/Widgets/Dialogs/WidgetProperties.aspx?inline=true"
}c=900;i=650}}if(h.config.CurrentGroupID){b+="&groupid="+h.config.CurrentGroupID}CMSPlugin.openModalDialog(b,a,c,i)},pluginInsertForms:function(c){var d="InsertForms",b={exec:function(e){CMSPlugin.openWidget(e,"WidgetProperties.aspx?inline=true&isnew=1&widgetname=BizForm","BizForm","900","600")}},a={label:c.lang.CMSPlugins.InsertForms.button,command:d,icon:c.config.CMSPluginUrl+"images/"+d+".png"};c.ui.addButton(d,a);c.addCommand(d,b)},pluginInsertMacro:function(b){var c="InsertMacro";var e="";if(b.config.ResolverName){e="resolver="+b.config.ResolverName}if(b.config.CurrentDocumentID){if(e){e+="&"}e+="documentid="+b.config.CurrentDocumentID}if(b.config.CurrentCulture){if(e){e+="&"}e+="culture="+b.config.CurrentCulture}var d={exec:function(g){CMSPlugin.currentEditor=g;var f=g.config.ApplicationPath+"CMSAdminControls/UI/Macros/Dialogs/Default.aspx?"+e;CMSPlugin.openModalDialog(f,"insertMacro",1024,660)}},a={label:b.lang.CMSPlugins.InsertMacro.button,command:c,icon:b.config.CMSPluginUrl+"images/"+c+".png"};b.ui.addButton(c,a);
b.addCommand(c,d)},pluginInsertPolls:function(a){var c="InsertPolls",b={exec:function(f){var e="WidgetProperties.aspx?inline=true&isnew=1&widgetname=Poll";CMSPlugin.openWidget(f,e,"Poll","900","660")}},d={label:a.lang.CMSPlugins.InsertPolls.button,command:c,icon:a.config.CMSPluginUrl+"images/"+c+".png"};a.ui.addButton(c,d);a.addCommand(c,b)},pluginInsertGroupPolls:function(a){var c="InsertGroupPolls",b={exec:function(f){var e="WidgetProperties.aspx?inline=true&isnew=1&widgetname=GroupPoll";CMSPlugin.openWidget(f,e,"GroupPoll","900","660")}},d={label:a.lang.CMSPlugins.InsertGroupPolls.button,command:c,icon:a.config.CMSPluginUrl+"images/"+c+".png"};a.ui.addButton(c,d);a.addCommand(c,b)},pluginInsertRating:function(c){var d="InsertRating",b={exec:function(e){CMSPlugin.openWidget(e,"WidgetProperties.aspx?inline=true&isnew=1&widgetname=ContentRating_1","ContentRating_1","715","550")}},a={label:c.lang.CMSPlugins.InsertRating.button,command:d,icon:c.config.CMSPluginUrl+"images/"+d+".png"};c.ui.addButton(d,a);c.addCommand(d,b)
},pluginKeyPress:function(c){var d=false,b=false,a=false;c.on("instanceReady",function(k){var j=function(e){return(e.ctrlKey&&e.altKey)},i=function(e){var l=e.data;l.key=l.getKey();l.ctrlKey=d;l.altKey=b;l.shiftKey=a;return l},h=function(l){var m,e=l.data.$.keyCode;if(e===17){d=true}else{if(e===16){a=true}else{if(e===18){b=true}else{m=i(l);if(!j(m)){g(m)}}}}},f=function(l){var m,e=l.data.$.keyCode;if(e===17){d=false}else{if(e===16){a=false}else{if(e===18){b=false}else{m=i(l);if(j(m)){g(m)}}}}},g=function(e){if(!window.disableShortcuts){if(window.HtmlEditor){return window.HtmlEditor.keyPressed(e)}else{if((window.parent!==null)&&window.parent.HtmlEditor){return window.parent.HtmlEditor.keyPressed(e)}}}return true};k.editor.document.on("keydown",h);k.editor.document.on("keyup",f);k.editor.on("mode",function(m){var l=m.editor;if(l.mode!="source"){l.document.on("keydown",h);l.document.on("keyup",f)}})})},pluginInsertYouTube:function(c){var d="InsertYouTubeVideo",b={exec:function(h){CMSPlugin.currentEditor=h;var g;if(h.config.IsLiveSite){g=h.config.ApplicationPath+"CMSFormControls/LiveSelectors/InsertYouTubeVideo/Default.aspx"
}else{g=h.config.ApplicationPath+"CMSFormControls/Selectors/InsertYouTubeVideo/Default.aspx"}CMSPlugin.openModalDialog(g,"youtube",1024,660)}},f={label:c.lang.CMSPlugins.InsertYouTubeVideo.button,command:d,icon:c.config.CMSPluginUrl+"images/"+d+".png"},a=function(g){var h=g.data.element;if(h.is("img")&&h.getAttribute("cms_youtube")=="true"){g.editor.execCommand(d)}},e={youtube:{label:c.lang.CMSPlugins.InsertYouTubeVideo.menu,command:d,group:d,icon:c.config.CMSPluginUrl+"images/"+d+".png"}};c.addCommand(d,b);c.ui.addButton(d,f);c.on("doubleclick",a);if(c.addMenuItems){c.addMenuGroup(d);c.addMenuItems(e)}if(c.contextMenu){c.contextMenu.addListener(function(g){if(g&&g.is("img")&&g.getAttribute("cms_youtube")=="true"){return{youtube:CKEDITOR.TRISTATE_OFF}}})}},pluginInsertWidget:function(c){var f="InsertWidget",d={exec:function(g){CMSPlugin.openWidget(g,"WidgetSelector.aspx?isnew=true&inline=true",null,"90%","85%")},open:function(i,h){h=h||CMSPlugin.currentEditor;var g;if(h.config.IsLiveSite){g=h.config.ApplicationPath+"CMSModules/Widgets/LiveDialogs/WidgetProperties.aspx?inline=true&isnew=1&widgetid="+i
}else{g=h.config.ApplicationPath+"CMSModules/Widgets/Dialogs/WidgetProperties.aspx?inline=true&isnew=1&widgetid="+i}if(h.config.CurrentGroupID){g+="&groupid="+h.config.CurrentGroupID}CMSPlugin.openModalDialog(g,"widget",950,"95%")}},b={label:c.lang.CMSPlugins.InsertWidget.button,command:f,icon:c.config.CMSPluginUrl+"images/"+f+".png"},e=function(g){var h=g.data.element;if(h.is("img")&&h.getAttribute("cke_widget")=="true"){g.editor.execCommand(f)}},a={widget:{label:c.lang.CMSPlugins.InsertWidget.menu,command:f,group:f,icon:c.config.CMSPluginUrl+"images/"+f+".png"}};c.addCommand(f,d);c.ui.addButton(f,b);c.on("doubleclick",e);if(c.addMenuItems){c.addMenuGroup(f);c.addMenuItems(a)}if(c.contextMenu){c.contextMenu.addListener(function(g){if(g&&g.is("img")&&g.getAttribute("cke_widget")=="true"){return{widget:CKEDITOR.TRISTATE_OFF}}})}},pluginInsertImageOrMedia:function(c){var e="InsertImageOrMedia",f={exec:function(i){var h=window.unescape(i.config.MediaDialogWidth);var g=window.unescape(i.config.MediaDialogHeight);CMSPlugin.currentEditor=i;
CMSPlugin.openModalDialog(i.config.MediaDialogURL,"imageormedia",h,g)}},b={label:c.lang.CMSPlugins.InsertImageOrMedia.button,command:e,icon:c.config.CMSPluginUrl+"images/"+e+".png"},a=function(g){var j=g.data.element;if(g.editor.config.removeButtons){for(var h in g.editor.config.removeButtons){if(g.editor.config.removeButtons[h]==="InsertImageOrMedia"){g.cancel();return}}}if(j.is("img")&&((j.getAttribute("cms_media")==="true")||!j.data("cke-realelement"))){g.editor.execCommand(e);g.cancel()}},d={imageormedia:{label:c.lang.CMSPlugins.InsertImageOrMedia.menu,command:e,group:e,icon:c.config.CMSPluginUrl+"images/"+e+".png"}};c.addCommand(e,f);c.ui.addButton(e,b);c.on("doubleclick",a,null,null,1);if(c.addMenuItems){c.addMenuGroup(e);c.addMenuItems(d)}if(c.contextMenu){c.contextMenu.addListener(function(g){if(g&&g.is("img")&&(g.getAttribute("class")!="cke_anchor")&&(g.data("cke-real-element-type")!="flash")&&((g.getAttribute("cms_media")=="true")||(g.getAttribute("cms_disable_media")!="true"))){return{imageormedia:CKEDITOR.TRISTATE_OFF}
}})}},pluginInsertLink:function(c){var e="InsertLink",f={exec:function(i){var h=window.unescape(i.config.LinkDialogWidth);var g=window.unescape(i.config.LinkDialogHeight);CMSPlugin.currentEditor=i;CMSPlugin.openModalDialog(i.config.LinkDialogURL,"imageormedia",h,g)}},d={label:c.lang.CMSPlugins.InsertLink.button,command:e,icon:c.config.CMSPluginUrl+"images/"+e+".png"},b=function(g){var j;try{j=CKEDITOR.plugins.link.getSelectedLink(c)||g.data.element}catch(k){}if(g.editor.config.removeButtons){for(var h in g.editor.config.removeButtons){if(g.editor.config.removeButtons[h]==="InsertLink"){g.cancel();return}}}if(j){if(!j.isReadOnly()&&(g.editor.config.toolbar!="Disabled")){if(j.is("a")){if(j.getAttribute("name")&&!j.getAttribute("href")){g.data.dialog="anchor"}else{g.editor.execCommand(e);g.cancel()}}else{if(j.is("img")&&j.data("cke-real-element-type")=="anchor"){g.data.dialog="anchor"}}}else{g.stop()}}},a={insertLink:{label:c.lang.CMSPlugins.InsertLink.menu,command:e,group:e,icon:c.config.CMSPluginUrl+"images/"+e+".png"}};
c.addCommand(e,f,1);c.ui.addButton(e,d);c.on("doubleclick",b,null,null,1);if(c.addMenuItems){c.addMenuGroup(e);c.addMenuItems(a)}if(c.contextMenu){c.contextMenu.addListener(function(h){if(!h||h.isReadOnly()){return null}var g=(h.is("img")&&h.data("cke-real-element-type")=="anchor");if(!g){if(!(h=CKEDITOR.plugins.link.getSelectedLink(c))){return null}g=(h.getAttribute("name")&&!h.getAttribute("href"))}if(!g){return{insertLink:CKEDITOR.TRISTATE_OFF}}})}},pluginQuicklyInsertMedia:function(a){var c="QuicklyInsertImage",b={exec:function(d){CMSPlugin.currentEditor=d;CMSPlugin.saveFocus(d)}};a.addCommand(c,b);a.ui.addButton(c,{label:a.lang.CMSPlugins.QuicklyInsertImage.button,icon:a.config.CMSPluginUrl+"images/"+c+".png",onRender:function(){if(!a.config.qimId){a.config.qimId=[]}a.config.qimId.push(this._.id);a.on("instanceReady",function(){window.InsertImageOrMedia=function(p,o,q,i,r){CMSPlugin.insert(r)};function k(i){if(i){var o=i.match(/(?:formGuid=)([a-z\d-]+)/i),p=i.match(/(?:documentid=)([\d]+)/i),q=i.match(/(?:parentid=)([\d]+)/i);
if((o)&&(q)&&(/^[a-f\d]{8}-[a-f\d]{4}-[a-f\d]{4}-[a-f\d]{4}-[a-f\d]{12}$/i.test(o[1]))&&(parseInt(q[1],10)>=0)){return true}if((p)&&(parseInt(p[1],10)>=0)){return true}}return false}for(l=0;l<a.config.qimId.length;l++){var m=a.config.qimId[l],n=document.getElementById(m);if((n!==null)&&(!n.QIM_set)){n.QIM_set=true;if(k(this.config.QuickInsertURL)&&!window.disableQim){n.className+=" CMS_QIM";jQuery(n).mouseenter(function(){CMSPlugin.currentEditor=a;CMSPlugin.saveFocus(a)});n.onmousemove=function(){CMSPlugin.currentEditor=a};var d=n.getElementsByTagName("span");var f;for(var l=0;l<d.length;l++){if(d[l].className.indexOf("cke_button_icon")>-1){f=d[l]}}if(typeof(f)!=="undefined"){f.style.position="relative";f.style.background="";var h=document.createElement("div");h.className="InnerDiv";h.style.position="absolute";h.style.top="0px";h.style.left="0px";h.style.display="inline-block";h.innerHTML='<img src="'+a.config.CMSPluginUrl+"images/"+c+'.png" style="width:16px; height:16px;" />';f.appendChild(h);var e=document.createElement("div");
e.className="UploaderDiv";e.style.position="absolute";e.style.top="0px";e.style.width="16px";e.style.height="16px";e.style.visibility="visible";e.style.opacity="1";e.innerHTML='<iframe name="QuickInsertImage" src="'+a.config.QuickInsertURL+"&containerid="+m+'" frameborder="0" marginWidth="0" marginHeight="0" scrolling="no" border="0" style="width:16px; height:16px; overflow:hidden;" allowtransparency="true" ></iframe>';f.appendChild(e);var g=document.createElement("div");g.className="LoadingDiv";g.style.position="absolute";g.style.opacity="1";g.style.display="none";g.style.top="0px";g.style.left="0px";g.innerHTML='<img src="'+a.config.ApplicationPath+'CMSPages/GetResource.ashx?image=Design/Preloaders/preload16.gif" style="width:16px; height:16px;" />';f.appendChild(g);var j=document.createElement("script");j.type="text/javascript";j.src=a.config.ApplicationPath+"CMSModules/Content/Controls/Attachments/DirectFileUploader/DirectFileUploader.js";n.appendChild(j)}}else{n.parentNode.removeChild(n)}}}})}});a.on("mode",function(){if(a.config.qimId){for(var e=0;
e<a.config.qimId.length;e++){var f=a.config.qimId[e],g=document.getElementById(f);if(g){var d=g.getElementsByTagName("iframe");if(a.mode=="source"){g.className+=" cke_button_disabled";if((d)&&(d.length===1)){d[0].style.display="none"}}else{g.className=g.className.replace(/\s+cke_button_disabled/ig,"");if((d)&&(d.length===1)){d[0].style.display=""}}}}}})},pluginInsertStrandsRecommender:function(c){var d="InsertStrandsRecommender",b={exec:function(f){CMSPlugin.currentEditor=f;var e=f.config.ApplicationPath+"CMSModules/StrandsRecommender/Pages/InsertEmailWidget.aspx";CMSPlugin.openModalDialog(e,"strandsRecommender",1000,660)}},a={label:c.lang.CMSPlugins.InsertStrandsRecommender.button,command:d,icon:c.config.CMSPluginUrl+"images/"+d+".png"};c.ui.addButton(d,a);c.addCommand(d,b)},pluginForumButtons:function(d){var j="InsertQuote",i={exec:function(k){k.insertHtml("[quote=][/quote]")}},h={label:d.lang.CMSPlugins.InsertQuote.button,command:j,icon:d.config.CMSPluginUrl+"images/"+j+".png"},e="InsertImage",g={exec:function(l){var k=prompt(l.lang.CMSPlugins.InsertQuote.prompturl,"http://");
if(k){l.insertHtml("[img]"+k+"[/img]")}}},f={label:d.lang.CMSPlugins.InsertImage.button,command:e,icon:d.config.CMSPluginUrl+"images/"+e+".png"},c="InsertUrl",a={exec:function(l){var k=prompt(l.lang.CMSPlugins.InsertUrl.prompturl,"http://");if(k){var m=prompt(l.lang.CMSPlugins.InsertUrl.promptdesc,"");l.insertHtml("[url="+k+"]"+m+"[/url]")}}},b={label:d.lang.CMSPlugins.InsertUrl.button,command:c,icon:d.config.CMSPluginUrl+"images/"+c+".png"};d.ui.addButton(j,h);d.addCommand(j,i);d.ui.addButton(e,f);d.addCommand(e,g);d.ui.addButton(c,b);d.addCommand(c,a)},initMaximalization:function(a){a.on("maximize",function(f){var d=f.data;if(a.config.sharedSpaces&&d==CKEDITOR.TRISTATE_ON){jQuery(document.body).addClass("cms-bootstrap");var i=jQuery("#"+a.config.sharedSpaces.top);var c=i.offset().top+i.outerHeight();var h=a.container.getChild(1);h.setStyle("top",c+"px");var g=CKEDITOR.document.getWindow().getViewPaneSize();var e=jQuery("#"+a.config.sharedSpaces.bottom);var b=g.height-c-e.outerHeight();a.resize(g.width,b,null,true)
}})},initPopupOpener:function(a){a.popup=function(c,e,b,d){CMSPlugin.openModalDialog(c,"CKEditorPopup",e,b,d)}},initContextMenu:function(f){var e={Image:"image",Link:"link",Unlink:"unlink",Flash:"flash",Table:"table"},g=(f.config.toolbar instanceof Array)?f.config.toolbar:f.config["toolbar_"+f.config.toolbar];for(var d=0;d<g.length;d++){var b=g[d];if(!b){continue}for(var c=0;c<b.length;c++){var a=b[c];if(e[a]){delete e[a]}}}for(var h in e){delete f._.menuItems[e[h]]}},initSelection:function(a){a.on("beforeCommandExec",function(b){CMSPlugin.saveFocus(b.editor)})},initDataProcesor:function(b){var a=b.dataProcessor,c=a&&a.dataFilter;if(c){c.addRules({elements:{"cke:object":function(f){if(f.attributes.codetype&&(f.attributes.codetype.toLowerCase()=="cmsinlinecontrol")){return CMSPlugin.createFakeControl(f,b)}else{var d=f.attributes,g=d.classid&&String(d.classid).toLowerCase();if(!g&&!CMSPlugin.isFlashEmbed(f)){for(var e=0;e<f.children.length;e++){if(f.children[e].name=="cke:embed"){if(!CMSPlugin.isFlashEmbed(f.children[e])){return null
}f.attributes.type="flash";return CMSPlugin.createFakeControl(f,b)}}return null}f.attributes.type="flash";return CMSPlugin.createFakeControl(f,b)}},"cke:embed":function(e){var d=null;if(CMSPlugin.isFlashEmbed(e)){e.attributes.type="flash";d=CMSPlugin.createFakeControl(e,b)}return d}}},3)}},getInline:function(g,o){var d={};if(g){var m=g.getAttribute("type"),b=g.getAttribute("width"),p=g.getAttribute("height");if(m){if(m.toLowerCase()=="media"){m=this.getMediaType(g)}d["cms_type"]=m}if(g.childNodes){var h=this.getPropertyPrefix(m);if(b){d[h+"width"]=b}if(p){d[h+"height"]=p}var j=g.childNodes.length;for(var f=0;f<j;f++){var c=g.childNodes[f];var a=c.getAttribute("name");var n=c.getAttribute("value");if(a){d[h+a]=n;if((h+a)==="flash_movie"){d["flash_url"]=n}}}}try{g=CKEDITOR.dom.element.get(o);if(g){var l=g.getAscendant("a",true);if(l){d[h+"link"]=l.getAttribute("data-cke-saved-href")||l.getAttribute("href");d[h+"target"]=l.getAttribute("target")}}}catch(k){}}return d},getPropertyPrefix:function(a){var b="";switch(a.toLowerCase()){case"youtubevideo":b="youtube_";
break;case"image":b="img_";break;case"audiovideo":b="av_";break;case"flash":b="flash_";break}return b},getInlineType:function(a){var b="";switch(a.toLowerCase()){case"youtubevideo":b="YouTubeVideo";break;case"image":b="Image";break;case"audiovideo":case"flash":b="Media";break;case"widget":b="Widget";break}return b},createCKElement:function(a){var b=this.getCurrentEditor();if(b){return b.document.createElement(a)}return null},insertInline:function(b,j){if(b){var p=this.getInlineType(b),o=this.getPropertyPrefix(b),d=this.getCurrentEditor(),i='<object codetype="CMSInlineControl" type="'+p+'" ',f={"img_link":1,"img_target":1},m={"img_hspace":-1,"img_vspace":-1,"img_borderwidth":-1,"flash_loop":"False","flash_autoplay":"False","flash_menu":"False","av_autoplay":"False","av_loop":"False","av_controls":"True"};if(j[o+"width"]){i+='width="'+j[o+"width"]+'" ';j[o+"width"]=null}if(j[o+"height"]){i+='height="'+j[o+"height"]+'" ';j[o+"height"]=null}i+=">";for(var g in j){if(!f[g]&&j[g]&&(j[g]!=m[g])){i+='<param name="'+g.replace(o,"")+'" value="'+j[g]+'" />'
}}i+="</object>";if(j["img_link"]){var n;try{CMSPlugin.restoreFocus(d);var s=d.getSelection();if(s.getType()==CKEDITOR.SELECTION_ELEMENT){var c=s.getSelectedElement();if(c.is("a")){n=c}}var k=s.getRanges(true)[0];k.shrink(CKEDITOR.SHRINK_TEXT);var l=k.getCommonAncestor();n=l.getAscendant("a",true)}catch(q){}if(!n){var r='<a href="'+j["img_link"]+'" ';if(j["img_target"]){r+='target="'+j["img_target"]+'" '}r+=">";i=r+i+"</a>"}else{var h={href:"javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/"},a=[];h["data-cke-saved-href"]=j["img_link"];if(j["img_target"]){h["target"]=j["img_target"]}else{a.push("target")}n.setAttributes(h);n.removeAttributes(a);n.setHtml(i);i=n.getOuterHtml()}}else{d.document.$.execCommand("unlink",false,null)}this.insertHtml(i)}},insertLink:function(o){var m={href:"javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/"},f=[],h=this.getCurrentEditor(),v=null,C=null,a=null,t=null;try{CMSPlugin.restoreFocus(h);B=h.getSelection();if(B.getType()==CKEDITOR.SELECTION_ELEMENT){var g=B.getSelectedElement();
if(g.is("a")){v=g}}q=B.getRanges(true)[0];q.shrink(CKEDITOR.SHRINK_TEXT);var u=q.getCommonAncestor();v=u.getAscendant("a",true)}catch(z){}if(o.link_url){var r=o.link_protocol||"",j=o.link_url||"";m["data-cke-saved-href"]=(j.indexOf("/")===0)?j:r+j}else{if(o.anchor_name){C=o.anchor_name||"",a=o.anchor_custom||"",t=o.anchor_id||"";m["data-cke-saved-href"]="#"+(C||a||t||"")}else{if(o.email_to){var s=o.email_cc,y=o.email_bcc,k=o.email_subject,n=o.email_body,l=[];if(s){l.push("cc="+s)}if(y){l.push("bcc="+y)}if(k){l.push("subject="+k)}if(n){l.push("body="+n)}l=l.length?"?"+l.join("&"):"";m["data-cke-saved-href"]="mailto:"+o.email_to+l}}}if(o.link_target){m.target=o.link_target}else{f.push("target")}if(o.link_url){var A=function(i,e,D){var E=i[e];if(E){m[D]=E}else{f.push(D)}};A(o,"link_url","href");A(o,"link_id","id");A(o,"link_target","target");A(o,"link_class","class");A(o,"link_tooltip","title");A(o,"link_style","style");if(o.link_name){m["name"]=m["data-cke-saved-name"]=o.link_name;m["class"]=(m["class"]?m["class"]+" ":"")+"cke_anchor"
}else{f=f.concat(["data-cke-saved-name","name"])}}if(!v){var B=h.getSelection(),d=B.getRanges(true),q=d[0],p,x;if(d.length==1&&q.collapsed){p=new CKEDITOR.dom.text(o.email_linktext?o.email_linktext:o.email_to?o.email_to:o.anchor_linktext?o.anchor_linktext:o.anchor_name?o.anchor_name:o.link_text?o.link_text:o.link_url,h.document);d[0].insertNode(p);d[0].selectNodeContents(p);B.selectRanges(d)}x=new CKEDITOR.style({element:"a",attributes:m});x.type=CKEDITOR.STYLE_INLINE;x.applyToRange(q);if(o.link_id){var c=h.document.$.getElementsByTagName("a");for(var w=0;w<c.length;w++){if(c[w].getAttribute("href")==m.href){c[w].id=o.link_id;break}}}}else{var b=v;b.setAttributes(m);b.removeAttributes(f);if(b.getAttribute("name")){b.addClass("cke_anchor")}else{b.removeClass("cke_anchor")}if(this.fakeObj){h.createFakeElement(b,"cke_anchor","anchor").replace(this.fakeObj)}delete v}},insertImage:function(f){var g=this.createCKElement("img");if(g!=null){if(f.img_id){g.$.id=f.img_id}if(f.img_url){g.$.src=f.img_url;g.$.setAttribute("data-cke-saved-src",f.img_url)
}if(f.img_alt){g.$.alt=f.img_alt}else{if(f.img_tooltip){g.$.alt=f.img_tooltip}else{g.$.alt=""}}if(f.img_tooltip){g.$.title=f.img_tooltip}if(f.img_class){g.$.setAttribute("class",f.img_class)}if(f.img_dir){g.$.dir=f.img_dir}if(f.img_usemap){g.$.useMap=f.img_usemap}if(f.img_longdescription){g.$.setAttribute("longdesc",f.img_longdescription)}if(f.img_lang){g.$.lang=f.img_lang}if(f.img_style){g.setAttribute("style",f.img_style);if(g.$.style.cssStyle!=undefined){g.$.style.cssStyle=f.img_style}if(g.$.style.cssText!=undefined){g.$.style.cssText=f.img_style}}if((f.img_width)&&(parseInt(f.img_width,10)>=0)){g.$.style.width=parseInt(f.img_width,10)+"px"}if((f.img_height)&&(parseInt(f.img_height,10)>=0)){g.$.style.height=parseInt(f.img_height,10)+"px"}if((f.img_borderwidth)&&(parseInt(f.img_borderwidth,10)>=0)){g.$.style.borderWidth=f.img_borderwidth+"px";g.$.style.borderStyle="solid"}if(f.img_bordercolor){try{g.$.style.borderColor=f.img_bordercolor}catch(d){g.$.style.borderColor=""}}if(f.img_align){if((f.img_align=="left")||(f.img_align=="right")){if(g.$.style.cssFloat!=undefined){g.$.style.cssFloat=f.img_align
}if(g.$.style.styleFloat!=undefined){g.$.style.styleFloat=f.img_align}}else{if(g.$.style.verticalAlign!=undefined){g.$.style.verticalAlign=f.img_align}if(g.$.style["vartical-align"]!=undefined){g.$.style["vartical-align"]=f.img_align}}}if((f.img_vspace)||(f.img_hspace)){var a=parseInt(f.img_vspace,10),b=parseInt(f.img_hspace,10);if((a==b)&&(a>=0)){g.$.style.margin=b+"px"}else{if((a==b)&&(a==-1)){}else{g.$.style.margin=(a>=0?a+"px ":"auto ")+(b>=0?b+"px":"auto")}}}if(f.img_link||f.img_behavior){var c=this.createCKElement("a");if(f.img_link){c.$.href=f.img_link;c.$.setAttribute("data-cke-saved-href",f.img_link)}if(f.img_target){c.$.setAttribute("target",f.img_target)}else{if(f.img_behavior){c.$.setAttribute("target",f.img_behavior)}}c.append(g);this.insertElement(c)}else{this.insertElement(g)}}},insertHtml:function(a){var b=this.getCurrentEditor();if(b){CMSPlugin.restoreFocus(b);b.insertHtml(a)}},insertElement:function(a){var b=this.getCurrentEditor();if(b){CMSPlugin.restoreFocus(b);b.insertElement(a)}},insert:function(b){if(b){var a=b.cms_type;
if(a){this.insertInline(a,b)}else{if(b.link_url||b.email_to||b.anchor_name){this.insertLink(b)}else{if(b.img_url){this.insertImage(b)}}}}},saveFocus:function(a){CMSPlugin.selection=a.getSelection();if(CMSPlugin.selection){CMSPlugin.selectedElement=CMSPlugin.selection.getSelectedElement();CMSPlugin.selectionBookmarks=CMSPlugin.selection.createBookmarks2()}else{CMSPlugin.selectedElement=null;CMSPlugin.selectionBookmarks=null}},restoreFocus:function(a){if(CMSPlugin.selection){if(CMSPlugin.selectionBookmarks){CMSPlugin.selection.selectBookmarks(CMSPlugin.selectionBookmarks)}else{if(CMSPlugin.selectedElement){CMSPlugin.selection.selectElement(CMSPlugin.selectedElement)}else{a.focus()}}}else{a.focus()}},openModalDialog:function(d,c,e,a,b){window.modalDialog(d,c,e,a,b)},beforeInit:function(a){this.pluginKeyPress(a)},init:function(a){this.initCss(a);this.initMaximalization(a);this.initSelection(a);this.pluginInsertForms(a);this.pluginInsertMacro(a);this.pluginInsertPolls(a);this.pluginInsertGroupPolls(a);this.pluginInsertRating(a);
this.pluginInsertYouTube(a);this.pluginInsertWidget(a);this.pluginInsertImageOrMedia(a);this.pluginInsertLink(a);this.pluginQuicklyInsertMedia(a);this.pluginInsertStrandsRecommender(a);this.pluginForumButtons(a)},afterInit:function(a){this.initContextMenu(a);this.initDataProcesor(a);this.initPopupOpener(a)}};CKEDITOR.plugins.add("CMSPlugins",CMSPlugin);CKEDITOR.on("instanceReady",function(a){if(CKeditor_OnComplete){CKeditor_OnComplete(a.editor)}});